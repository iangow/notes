<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ian D. Gow">
<meta name="dcterms.date" content="2026-01-21">

<title>Some benchmarks with comp.g_secd – notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a-little-about-wrds-data" id="toc-a-little-about-wrds-data" class="nav-link active" data-scroll-target="#a-little-about-wrds-data"><span class="header-section-number">1</span> A little about WRDS data</a></li>
  <li><a href="#exploration-of-comp.g_secd-sas-data" id="toc-exploration-of-comp.g_secd-sas-data" class="nav-link" data-scroll-target="#exploration-of-comp.g_secd-sas-data"><span class="header-section-number">2</span> Exploration of <code>comp.g_secd</code> (SAS data)</a>
  <ul class="collapse">
  <li><a href="#the-benchmark-query" id="toc-the-benchmark-query" class="nav-link" data-scroll-target="#the-benchmark-query"><span class="header-section-number">2.1</span> The benchmark query</a></li>
  </ul></li>
  <li><a href="#using-the-wrds-postgresql-server" id="toc-using-the-wrds-postgresql-server" class="nav-link" data-scroll-target="#using-the-wrds-postgresql-server"><span class="header-section-number">3</span> Using the WRDS PostgreSQL server</a></li>
  <li><a href="#using-parquet-data" id="toc-using-parquet-data" class="nav-link" data-scroll-target="#using-parquet-data"><span class="header-section-number">4</span> Using Parquet data</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="g_secd.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Some benchmarks with <code>comp.g_secd</code></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ian D. Gow <a href="mailto:iandgow@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-6243-8409" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">21 January 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>In this note, I use a simple query to benchmark performance of various approaches to accessing data in <code>comp.g_secd</code>. Many international researchers will know that <code>comp.g_secd</code> holds daily security-level data for non-US firms covered by Compustat Global. It is the global version of the North America daily security file, <code>comp.secd</code>, and, I guess, the closest analogue of <code>crsp.dsf</code> for finance and accounting researchers studying non-US firms.</p>
<p>I use this data set to do some benchmarking. I find that a query using <code>comp.g_secd</code> that takes 6 minutes using SAS on the WRDS servers, takes about 1 minute using the WRDS PostgreSQL server and about 0.2 seconds using a local Parquet file. The Parquet file occupies less than 4 GB on my hard drive, which compares with about 145 GB for the SAS file on the WRDS server. While creating the Parquet file takes 45 minutes, this may be a reasonable trade-off for a researcher who is analysing <code>comp.g_secd</code> frequently and does not need the very latest iteration of <code>comp.g_secd</code> for research purposes.</p>
<div class="callout callout-style-default callout-tip callout-titled" data-text-align="left">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>In writing this note, I used the R packages listed below.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> I also used Python for portions of the code. This note was written using <a href="https://quarto.org">Quarto</a> and compiled with <a href="https://posit.co/products/open-source/rstudio/">RStudio</a>, an integrated development environment (IDE) for working with R and Python. The source code for this note is available <a href="https://raw.githubusercontent.com/iangow/notes/main/g_secd.qmd">here</a> and the latest version of this PDF is <a href="https://raw.githubusercontent.com/iangow/notes/main/g_secd.pdf">here</a>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(farr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<section id="a-little-about-wrds-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> A little about WRDS data</h1>
<p>In the beginning was the … SAS data. Well, not really. Surely the databases such as CRSP and Compustat that have powered research in accounting and finance since the <a href="https://youtu.be/tRSaz5TIyno?t=500">beginning of time</a> predate SAS and WRDS. But since long before I entered a business PhD program, WRDS has been the preeminent provider of data to academic researchers and SAS was long the form in which WRDS provided data.</p>
<p>In 2011, I created a predecessor of my <code>wrds2pg</code> Python package to create a PostgreSQL database containing WRDS data.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> The <code>wrds2pg</code> package has developed over time, but almost nothing has changed since 2023.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>By early 2017, WRDS offered its own PostgreSQL database. Early on the data in the WRDS PostgreSQL database was not complete and it seemed to have been created from the SAS data files, but generally was of lower quality than what I had in my database (e.g., <code>wrds2pg</code> did a better job with inference of data types and handled non-Latin characters better). But today it is unclear whether the SAS data or the PostgreSQL data are the “canonical” version of the data; they can probably both be considered canonical data sources.</p>
<p>Working in R with data in databases such as PostgreSQL has been greatly facilitated by <a href="https://dbplyr.tidyverse.org">the <code>dbplyr</code> Tidyverse package</a>. I don’t recall exactly when I started using <code>dbplyr</code>, but I have email exchanges with Hadley Wickham about backend functionality for PostgreSQL as far back as 2015 and I can barely remember the days when I didn’t have it. I would say that <code>dbplyr</code> is what made the code approach used in <span class="citation" data-cites="gow2024empirical">Gow and Ding (<a href="#ref-gow2024empirical" role="doc-biblioref">2024</a>)</span> feasible, even if <a href="https://raw.githubusercontent.com/iangow/notes/main/dbplyr-news.pdf">some critical pieces</a> fell into place after work on the book began. Today, packages such as Ibis mean that a similar approach could be taken with Python.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>In late 2023, I added functionality to <code>wrds2pg</code> that allows SAS files to be turned into Parquet files. The Parquet file format is provided by Apache Arrow, “a software development platform for building high performance applications that process and transport large data sets.”<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> The Parquet format offers much of the versatility of CSV files, while also allowing for a rich system of data types and random access to data. As seen in <a href="https://iangow.github.io/far_book/glms.html">Chapter 23</a> of <span class="citation" data-cites="gow2024empirical">Gow and Ding (<a href="#ref-gow2024empirical" role="doc-biblioref">2024</a>)</span>, Parquet files can be combined with DuckDB to provide a lightweight, high-performance alternative to PostgreSQL</p>
<p>Also in late 2023, I created <a href="https://pypi.org/project/db2pq/">the <code>db2pq</code> Python library</a> to create Parquet files directly from a PostgreSQL database. Around the same time, I updated the <a href="https://iangow.github.io/far_book/">online version</a> of <span class="citation" data-cites="gow2024empirical">Gow and Ding (<a href="#ref-gow2024empirical" role="doc-biblioref">2024</a>)</span> to include a Parquet variant of the code and I used this approach when teaching courses based on the book in 2024. While the <code>db2pq</code> package has a mere 29 commits on [GitHub] at the time of writing, it has seen more recent development than the <code>wrds2pg</code> package.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<p>So in this note, I will compare three alternative approaches to <code>comp.g_secd</code>: SAS data (using SAS), PostgreSQL data (using R), and Parquet data (using R).<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p>With that short detour into the history of WRDS data and so on out of the way, I now return to the topic of <code>comp.g_secd</code> and I focus initially on the “original” SAS data.</p>
</section>
<section id="exploration-of-comp.g_secd-sas-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Exploration of <code>comp.g_secd</code> (SAS data)</h1>
<p>While researchers looking for security returns for US-listed firms data can use CRSP’s <code>crsp.dsf</code>, CRSP does not cover non-US firms. Fortunately, <code>comp.g_secd</code> provides high-quality data and (importantly) merging with Compustat fundamental data (i.e., <code>comp.g_funda</code>) is facilitated by the shared identifiers across these tables (i.e., <code>gvkey</code> and <code>iid</code>).</p>
<p>The fields on <code>comp.g_secd</code> include its security identifiers. The firm identifier is <code>gvkey</code> and the issue identifier—crucial for firms with multiple share classes or listings—is <code>iid</code>. As I will confirm below, the natural <strong>primary key</strong> for <code>comp.g_secd</code> is <code>(gvkey, iid, datadate)</code>.</p>
<p>There are two files on the WRDS server for <code>comp.g_secd</code>: <code>g_secd.sas7bdat</code> (144.8 GB) and <code>g_secd.sas7bndx</code> (23.1 GB).<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> The <code>g_secd.sas7bdat</code> file is the SAS data file that will be familiar to users of SAS. But even SAS users may be unfamiliar with <code>g_secd.sas7bndx</code>, which is the index file. Index files have much the same role for SAS data files as indexes do for tables in SQL databases, such as the WRDS PostgreSQL database that I will discuss in a moment.</p>
<p>If a SAS user copies <code>g_secd.sas7bdat</code> onto her computer <em>without</em> the index, then query performance is likely to be degraded in many cases. We can inspect the indexes that WRDS has created using the <code>PROC CONTENTS</code> procedure from SAS. If you have my package <code>wrds2pg</code> installed, then <code>proc_contents()</code> provides a convenient way to access this procedure in Python:<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wrds2pg <span class="im">import</span> proc_contents</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>proc_contents(<span class="st">"g_secd"</span>, <span class="st">"comp"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The output from the Python code above is shown in Listings <a href="#lst-contents-1" class="quarto-xref">1</a>, <a href="#lst-contents-2" class="quarto-xref">2</a>, and <a href="#lst-contents-3" class="quarto-xref">3</a> at the end of this document. The information on the indexes is provided at the bottom of <a href="#lst-contents-3" class="quarto-xref">Listing&nbsp;3</a>, where you can see that there are five indexes. Four indexes relate to single fields: <code>isin</code>, <code>sedol</code>, <code>exchg</code>, and <code>fic</code>. Each of these indexes improves performance of queries that focus on particular values of the associated variable. The fifth index is on <code>gvkey</code> and <code>datadate</code> and allows one to quickly zero in on particular combinations of those variables, as would be the case if merging with a subset of <code>comp.g_funda</code> for which <code>gvkey</code> and <code>datadate</code> is a primary key.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<section id="the-benchmark-query" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-benchmark-query"><span class="header-section-number">2.1</span> The benchmark query</h2>
<p>Now that we understand a little about <code>comp.g_secd</code> and its SAS manifestation, I will introduce my benchmark query. The idea of the benchmark is that it is somewhat representative of the kinds of things a researcher might want to do with <code>comp.g_secd</code> without being overly complicated. Additionally, the benchmark should require actually looking at a significant part of the data (in this case <em>all</em> records) and, to keep it interesting, it should not be able to use a short cut of simply looking at an index.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<p>The SAS version of my benchmark query simply counts the number of rows associated with each value of <code>curcdd</code>, which <a href="#lst-contents-2" class="quarto-xref">Listing&nbsp;2</a> tells us represents “ISO Currency Code - Daily”:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CREATE</span> <span class="kw">TABLE</span> curcdd_counts <span class="kw">AS</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> curcdd, count(*) <span class="kw">AS</span> <span class="fu">n</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> comp.g_secd</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> curcdd</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ORDER</span> <span class="kw">BY</span> <span class="fu">n</span> DESC;</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span>=curcdd_counts;</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>I put this SAS code into a file <code>g_secd.sas</code> in my home directory on the WRDS server and ran <code>qsas g_secd.sas</code>. Inspecting <code>g_secd.log</code> a few minutes later, I see <code>The SAS System used: real time 6:08.66</code>. So SAS needs more than 5 minutes to run this query. And here is a sample of the output in <code>g_secd.lst</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>                                 The SAS <span class="fu">System</span>                                <span class="dv">1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                        Wednesday, February <span class="dv">18</span>, <span class="dv">2026</span> <span class="dv">01</span>:<span class="dv">55</span>:<span class="dv">00</span> PM</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                           Obs    curcdd           <span class="fu">n</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">1</span>     EUR      <span class="dv">48130467</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">2</span>     JPY      <span class="dv">31841749</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">3</span>     CNY      <span class="dv">25687260</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">4</span>     INR      <span class="dv">20676444</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">5</span>     GBP      <span class="dv">20636852</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">6</span>     KRW      <span class="dv">15657569</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">7</span>     HKD      <span class="dv">14717583</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">8</span>     AUD      <span class="dv">13812258</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="using-the-wrds-postgresql-server" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Using the WRDS PostgreSQL server</h1>
<p>Now, let’s do the same query using the WRDS PostgreSQL server. I have my WRDS ID in the <code>WRDS_ID</code> environment variable and I have my password stored in <code>~/.pgpass</code>, so I can use PostgreSQL-related environment variables to point R to the WRDS server.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">PGHOST =</span> <span class="st">"wrds-pgdata.wharton.upenn.edu"</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">PGPORT =</span> <span class="dv">9737</span>L,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">PGUSER =</span> <span class="fu">Sys.getenv</span>(<span class="st">"WRDS_ID"</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">PGDATABASE =</span> <span class="st">"wrds"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now, two lines of code suffice to set up a connection to <code>comp.g_secd</code> on the WRDS PostgreSQL server.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RPostgres<span class="sc">::</span><span class="fu">Postgres</span>())</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>g_secd <span class="ot">&lt;-</span> <span class="fu">tbl</span>(db, <span class="fu">Id</span>(<span class="at">schema =</span> <span class="st">"comp"</span>, <span class="at">table =</span> <span class="st">"g_secd"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>With <code>dbplyr</code>, we can write the query as follows.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>g_secd <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(curcdd) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system_time</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   user  system elapsed 
  0.014   0.006  37.993 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 115 × 2
   curcdd        n
   &lt;chr&gt;   &lt;int64&gt;
 1 EUR    48037544
 2 JPY    31823971
 3 CNY    25635258
 4 INR    20653714
 5 GBP    20619033
 6 KRW    15641761
 7 HKD    14697439
 8 AUD    13800095
 9 TWD    11646012
10 THB     8980840
# ℹ 105 more rows</code></pre>
</div>
</div>
<p>We see two things here. First, the output is slightly different from that above, suggesting that the SAS data are slightly newer (higher numbers) than the PostgreSQL data. I will return to this point below.</p>
<p>Second, the PostgreSQL server delivers the query about six times faster than SAS does.</p>
</section>
<section id="using-parquet-data" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Using Parquet data</h1>
<p>Now, I do it again using Parquet data. The first step is to update (or get the data) using the following two lines of Python code. Again, this code relies on <code>WRDS_ID</code> and <code>DATA_DIR</code> environment variables. I specify <code>archive=True</code> to keep a copy of any existing <code>g_secd.parquet</code> file I have.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> db2pq <span class="im">import</span> wrds_update_pq</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>wrds_update_pq(<span class="st">"g_secd"</span>, <span class="st">"comp"</span>, archive<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>comp.g_secd already up to date.
False</code></pre>
</div>
</div>
<p>When I did this update earlier today, it took a bit over 45 minutes on my computer. But, as can be seen above, <code>wrds_update_pq()</code> will not fetch new data if the data are up to date.</p>
<p>However, WRDS updates Compustat data every day. As this may not be an update you’d want to be running every day, the daily updates might be “more bug than feature” for many researchers.</p>
<p>Now, two lines of code suffice to set up a connection to a DuckDB database pointing to the <code>comp.g_secd</code> Parquet file on my hard drive.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>())</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>g_secd <span class="ot">&lt;-</span> <span class="fu">load_parquet</span>(db, <span class="at">table =</span> <span class="st">"g_secd"</span>, <span class="at">schema =</span> <span class="st">"comp"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now, we can run exactly the same query as we did for the WRDS PostgreSQL server.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>g_secd <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(curcdd) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system_time</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   user  system elapsed 
  1.490   0.108   0.169 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 115 × 2
   curcdd        n
   &lt;chr&gt;     &lt;dbl&gt;
 1 EUR    48130467
 2 JPY    31841749
 3 CNY    25687260
 4 INR    20676444
 5 GBP    20636852
 6 KRW    15657569
 7 HKD    14717583
 8 AUD    13812258
 9 TWD    11656464
10 THB     8987656
# ℹ 105 more rows</code></pre>
</div>
</div>
<p>Wow! So <em>once we have the data in Parquet form</em>, the query is blazingly fast. Something taking over 6 minutes on the SAS “supercomputers” takes about 0.2 seconds on my consumer-grade Mac mini.</p>
<p>Note that the results match the output from the PostgreSQL server exactly, because we updated the data before running the query.</p>
<p>I now make a little Python function to get information about the size of the Parquet file that has been created.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> file_size(path) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    n_bytes <span class="op">=</span> path.stat().st_size</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> unit <span class="kw">in</span> [<span class="st">"B"</span>, <span class="st">"KB"</span>, <span class="st">"MB"</span>, <span class="st">"GB"</span>, <span class="st">"TB"</span>, <span class="st">"PB"</span>]:</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n_bytes <span class="op">&lt;</span> <span class="dv">1024</span>:</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>n_bytes<span class="sc">:.1f}</span><span class="ss"> </span><span class="sc">{</span>unit<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        n_bytes <span class="op">/=</span> <span class="dv">1024</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>n_bytes<span class="sc">:.1f}</span><span class="ss"> EB"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now, I run this function on the Parquet file created by <code>wrds_update_pq()</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data_dir <span class="op">=</span> Path(os.environ[<span class="st">"DATA_DIR"</span>]).expanduser()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> data_dir <span class="op">/</span> <span class="st">"comp"</span> <span class="op">/</span> <span class="st">"g_secd.parquet"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>file_size(path)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'3.8 GB'</code></pre>
</div>
</div>
<p>So the 57.71 GB PostgreSQL table is reduced to under 4 GB as a Parquet file.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> This is much more manageable!</p>
<p>Returning to the mismatch between the output from the SAS query and the PostgreSQL query, we can inspect the “last modified” data for the Parquet file, which are taken from the table comments on the PostgreSQL server.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> db2pq <span class="im">import</span> pq_last_modified</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Running this function on the main file tells us that the PostgreSQL table was updated yesterday, explaining why we see the difference from the WRDS SAS output above:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pq_last_modified(<span class="st">"g_secd"</span>, <span class="st">"comp"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'Merged Global Security Daily File (Updated 2026-02-17)'</code></pre>
</div>
</div>
<p>We can run the function with <code>archive=True</code> to see what we have in the archive:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pq_last_modified(<span class="st">"g_secd"</span>, <span class="st">"comp"</span>, archive<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 file_name  ... storage
0  g_secd_20250907T161453Z  ...   local
1  g_secd_20260120T070000Z  ...   local
2  g_secd_20260216T070000Z  ...   local

[3 rows x 6 columns]</code></pre>
</div>
</div>
<p>The one archived file I have has an update string taken from the SAS file existing on the WRDS server when that update occurred.<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></p>
<div id="lst-contents-1" class="listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-contents-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;1: Output from <code>PROC CONTENTS</code> with <code>comp.g_secd</code> (Part 1)
</figcaption>
<div aria-describedby="lst-contents-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>The SAS <span class="fu">System</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>The CONTENTS Procedure</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Data</span> <span class="kw">Set</span> Name        COMP.G_SECD                 Observations          <span class="dv">302322220</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>Member Type<span class="kw">          DATA</span>                        Variables             <span class="dv">54</span>       </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>Engine               V9                          Indexes               <span class="dv">5</span>        </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>Created              <span class="dv">02</span>/<span class="dv">17</span>/<span class="dv">2026</span> <span class="dv">10</span>:<span class="dv">58</span>:<span class="dv">06</span>         Observation <span class="kw">Length</span>    <span class="dv">480</span>      </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>Last Modified        <span class="dv">02</span>/<span class="dv">17</span>/<span class="dv">2026</span> <span class="dv">11</span>:<span class="dv">08</span>:<span class="dv">45</span>         Deleted Observations  <span class="dv">0</span>        </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>Protection                                       Compressed            NO       </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="kw">Data</span> <span class="kw">Set</span> Type                                    Sorted                YES      </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="kw">Label</span>                Merged Global Security                                     </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                     Daily <span class="kw">File</span>                                                 </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="kw">Data</span> Representation  SOLARIS_X86_64,                                            </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                     LINUX_X86_64, ALPHA_TRU64,                                 </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                     LINUX_IA64                                                 </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>Encoding             utf<span class="dv">-8</span>  Unicode (UTF<span class="dv">-8</span>)                                     </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                   Engine/Host Dependent Information</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="kw">Data</span> <span class="kw">Set</span> <span class="kw">Page</span> Size          <span class="dv">65536</span>                                      </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>Number of<span class="kw"> Data</span> <span class="kw">Set</span> Pages    <span class="dv">2222959</span>                                    </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>First<span class="kw"> Data</span> <span class="kw">Page</span>             <span class="dv">1</span>                                          </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="fu">Max</span> Obs per <span class="kw">Page</span>            <span class="dv">136</span>                                        </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>Obs <span class="kw">in</span> First<span class="kw"> Data</span> <span class="kw">Page</span>      <span class="dv">115</span>                                        </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="kw">Index</span> <span class="kw">File</span> <span class="kw">Page</span> Size        <span class="dv">8192</span>                                       </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>Number of <span class="kw">Index</span> <span class="kw">File</span> Pages  <span class="dv">2830784</span>                                    </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>Number of<span class="kw"> Data</span> <span class="kw">Set</span> Repairs  <span class="dv">0</span>                                          </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="kw">Filename</span>                    /wrds/comp/sasdata/d_global/g_secd.sas7bdat</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>Release Created             <span class="dv">9.0401</span>M7                                   </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>Host Created                Linux                                      </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>Inode Number                <span class="dv">2465334833</span>                                 </span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>Access Permission           rw-r-----                                  </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>Owner Name                  wrdsadmn                                   </span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="kw">File</span> Size                   <span class="dv">136</span>GB                                      </span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="kw">File</span> Size (bytes)           <span class="dv">145683906560</span>                               </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<div id="lst-contents-2" class="listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-contents-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;2: Output from <code>PROC CONTENTS</code> with <code>comp.g_secd</code> (Part 2)
</figcaption>
<div aria-describedby="lst-contents-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>                  Alphabetic <span class="kw">List</span> of Variables <span class="kw">and</span> Attributes</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a> # Variable   Type Len <span class="kw">Format</span>    <span class="kw">Informat</span> <span class="kw">Label</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="dv">46</span> ISIN       Char  <span class="dv">20</span> $<span class="dv">12</span>.               International Security               </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                                          Identification Number                </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="dv">48</span> SEDOL      Char  <span class="dv">20</span> $<span class="dv">7</span>.                SEDOL                                </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> ajexdi     Num    <span class="dv">8</span> F19<span class="dv">.8</span>     <span class="dv">20.8</span>     Adjustment Factor (Issue)-Cumulative </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="kw">by</span> Ex-<span class="fu">Date</span>                           </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="dv">34</span> anncdate   Num    <span class="dv">8</span> YYMMDDN8.          Dividend Declaration <span class="fu">Date</span>            </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> cheqv      Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Cash Equivalent Distributions        </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> cheqvgross Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Cash Equivalent Distributions, Gross </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> cheqvnet   Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Cash Equivalent Distributions,       </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                                          Net of Tax                           </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="dv">35</span> cheqvpayda Num    <span class="dv">8</span> YYMMDDN8.          Cash Equivalent Distributions        </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>   te                                     per Share Payment <span class="fu">Date</span>               </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> cheqvtm    Char   <span class="dv">2</span> $<span class="dv">2</span>.       $<span class="dv">2</span>.      Cash Equivalent Distributions        </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                                          Tax Code                             </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> conm       Char  <span class="dv">87</span> $<span class="dv">87</span>.      $<span class="dv">87</span>.     Company Name                         </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> cshoc      Num    <span class="dv">8</span> F19.      <span class="dv">19</span>.      Shares Outstanding                   </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> cshtrd     Num    <span class="dv">8</span> F29<span class="dv">.8</span>     <span class="dv">30.8</span>     Trading Volume - Daily               </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> curcdd     Char   <span class="dv">3</span> $<span class="dv">3</span>.       $<span class="dv">3</span>.      ISO Currency Code - Daily            </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> curcddv    Char   <span class="dv">3</span> $<span class="dv">3</span>.       $<span class="dv">3</span>.      ISO Currency Code - Dividend         </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> datadate   Num    <span class="dv">8</span> YYMMDDN8.<span class="kw">          Data</span> <span class="fu">Date</span> - Daily Prices             </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span> div        Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Dividends per Share - Ex             </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">Date</span> - Daily (Issue)                 </span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="dv">21</span> divd       Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Cash Dividends - Daily               </span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span> divdgross  Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Cash Dividends, Gross                </span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="dv">23</span> divdnet    Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Cash Dividends, Net of Tax           </span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="dv">36</span> divdpaydat Num    <span class="dv">8</span> YYMMDDN8.          Cash Dividends - Daily Payment <span class="fu">Date</span>  </span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>   e                                                                           </span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="dv">24</span> divdtm     Char   <span class="dv">2</span> $<span class="dv">2</span>.       $<span class="dv">2</span>.      Cash Dividend Tax Code               </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span> divgross   Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Cash Dividend including              </span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>                                          Special, Gross                       </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="dv">26</span> divnet     Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Cash Dividend including              </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>                                          Special, Net of Tax                  </span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="dv">27</span> divrc      Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     <span class="kw">Return</span> of Capital - Daily            </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="dv">28</span> divrcgross Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     <span class="kw">Return</span> of Capital, Gross             </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="dv">29</span> divrcnet   Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     <span class="kw">Return</span> of Capital, Net of Tax        </span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="dv">37</span> divrcpayda Num    <span class="dv">8</span> YYMMDDN8.          <span class="kw">Return</span> of Capital -                  </span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>   te                                     Daily Payment <span class="fu">Date</span>                   </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<div id="lst-contents-3" class="listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-contents-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;3: Output from <code>PROC CONTENTS</code> with <code>comp.g_secd</code> (Part 3)
</figcaption>
<div aria-describedby="lst-contents-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span> divsp      Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Special Cash Dividends - Daily       </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="dv">31</span> divspgross Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Special Cash Dividends, Gross        </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="dv">32</span> divspnet   Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Special Cash Dividends, Net of Tax   </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="dv">38</span> divsppayda Num    <span class="dv">8</span> YYMMDDN8.          Special Cash Dividends               </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>   te                                     - Daily Payment <span class="fu">Date</span>                 </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="dv">33</span> divsptm    Char   <span class="dv">2</span> $<span class="dv">2</span>.       $<span class="dv">2</span>.      Special Cash Dividend Tax Code       </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="dv">44</span> epf        Char   <span class="dv">1</span> $<span class="dv">1</span>.       $<span class="dv">1</span>.      Earnings Participation Flag          </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="dv">45</span> exchg      Num    <span class="dv">8</span> F6.       <span class="dv">6</span>.       Stock Exchange Code                  </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="dv">50</span> fic        Char   <span class="dv">3</span> $<span class="dv">3</span>.       $<span class="dv">3</span>.      Current ISO Country                  </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                                          Code - Incorporation                 </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="dv">51</span> gind       Char   <span class="dv">6</span> $<span class="dv">6</span>.       $<span class="dv">6</span>.      GIC Industries                       </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="dv">52</span> gsubind    Char   <span class="dv">8</span> $<span class="dv">8</span>.       $<span class="dv">8</span>.      GIC Sub-Industries                   </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> gvkey      Char   <span class="dv">6</span> $<span class="dv">6</span>.       $<span class="dv">6</span>.      Global Company <span class="kw">Key</span> - Daily Prices    </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> iid        Char   <span class="dv">3</span> $<span class="dv">3</span>.       $<span class="dv">3</span>.      Issue ID - Daily Price               </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="dv">53</span> loc        Char   <span class="dv">3</span> $<span class="dv">3</span>.       $<span class="dv">3</span>.      Current ISO Country                  </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                                          Code - Headquarters                  </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="dv">54</span> monthend   Num    <span class="dv">8</span><span class="kw">                    End</span> of <span class="fu">Month</span> Indicator               </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="dv">39</span> paydate    Num    <span class="dv">8</span> YYMMDDN8.          Dividend Payment <span class="fu">Date</span>                </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> prccd      Num    <span class="dv">8</span> F29<span class="dv">.8</span>     <span class="dv">30.8</span>     Price - <span class="fu">Close</span> - Daily                </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> prchd      Num    <span class="dv">8</span> F29<span class="dv">.8</span>     <span class="dv">30.8</span>     Price - High - Daily                 </span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> prcld      Num    <span class="dv">8</span> F29<span class="dv">.8</span>     <span class="dv">30.8</span>     Price - Low - Daily                  </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> prcod      Num    <span class="dv">8</span> F29<span class="dv">.8</span>     <span class="dv">30.8</span>     Price - <span class="fu">Open</span> - Daily                 </span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> prcstd     Num    <span class="dv">8</span> F6.       <span class="dv">6</span>.       Price Status Code - Daily            </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> qunit      Num    <span class="dv">8</span> F17<span class="dv">.4</span>     <span class="dv">18.4</span>     Price Quotation Unit                 </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="dv">40</span> recorddate Num    <span class="dv">8</span> YYMMDDN8.          Dividend Record <span class="fu">Date</span>                 </span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="dv">47</span> secstat    Char   <span class="dv">1</span> $<span class="dv">1</span>.       $<span class="dv">1</span>.      Security Status Marker               </span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="dv">41</span> split      Num    <span class="dv">8</span> F19<span class="dv">.8</span>     <span class="dv">20.8</span>     Stock Split Rate                     </span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="dv">42</span> splitf     Char   <span class="dv">8</span> $<span class="dv">8</span>.       $<span class="dv">8</span>.      Stock Split <span class="kw">Footnote</span>                 </span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="dv">49</span> tpci       Char   <span class="dv">8</span> $<span class="dv">8</span>.       $<span class="dv">8</span>.      Issue Type Code                      </span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="dv">43</span> trfd       Num    <span class="dv">8</span>                    Daily Total <span class="kw">Return</span> Factor            </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>     Alphabetic <span class="kw">List</span> of Indexes <span class="kw">and</span> Attributes</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>                            # of</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>                          <span class="kw">Unique</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>#    <span class="kw">Index</span>                Values    Variables</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    ISIN                  <span class="dv">92414</span>                   </span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    SEDOL                <span class="dv">122039</span>                   </span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    exchg                   <span class="dv">156</span>                   </span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    fic                     <span class="dv">131</span>                   </span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>    gvkey_datadate    <span class="dv">245430978</span>    gvkey datadate </span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>        Sort Information</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>Sortedby       gvkey iid datadate</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>Validated      YES               </span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>Character <span class="kw">Set</span>  ASCII             </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-gow2024empirical" class="csl-entry" role="listitem">
Gow, I.D., Ding, T., 2024. Empirical research in accounting: Tools and methods. Chapman &amp; Hall/CRC, London, UK. <a href="https://doi.org/10.1201/9781003456230">https://doi.org/10.1201/9781003456230</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Execute <code>install.packages(c("tidyverse", "DBI", "duckdb", "dbplyr", "farr", "RPostgres")</code> within R to install all the packages you need to run the code in this note.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>My original code was in Perl, but by <a href="https://github.com/iangow/wrds_pg/commit/9a7b27331a7f47bd7ab279dae28199e3daea0183">2015</a> I had Python code to do the same job, and by <a href="https://github.com/iangow/wrds2pg/commit/641f85ac527c6844f31cb5c7991d25db26551c01">2019</a> there was an installable Python package, created with the help of <a href="https://github.com/jingyujzhang">Jingyu Zhang</a>. Early on, I considered SQLite and MySQL as well as PostgreSQL, but I decided on PostgreSQL because of its rich type system, powerful SQL, and support for server programming (though I ended up not using the last one much). Though I had zero expertise, it seems that I somehow made the right choice. I was also an early adopter of RStudio in 2010 or 2011.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The only recent change was I recently exposed the (previously internal) <code>sas_to_pandas()</code> function that I used in <a href="https://raw.githubusercontent.com/iangow/notes/main/sas_to_pd.pdf">my recent note</a> on SAS and pandas.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Trying to do <span class="citation" data-cites="gow2024empirical">Gow and Ding (<a href="#ref-gow2024empirical" role="doc-biblioref">2024</a>)</span> using pandas and SQL would be painful and slow.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>See the Apache Arrow website at <a href="https://arrow.apache.org/overview/" class="uri">https://arrow.apache.org/overview/</a>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>A lot of early work involved using poorly documented libraries to keep the memory impact to a minimum and to facilitate the <code>wrds_update_pq()</code> conditional-update functionality.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Note that the “using R” part is relatively unimportant. For example, it would be easy to do everything with essentially identical performance using Python.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>If you look at <a href="#lst-contents-1" class="quarto-xref">Listing&nbsp;1</a>, you may notice “135GB”; this is incorrect and should be “135 GiB” (a GiB is a “binary” unit in which 1 GiB = <span class="math inline">\(2^{30}\)</span> = 1,073,741,824 bytes).<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Note that the following Python code use the environment variable <code>WRDS_ID</code>. Call <code>proc_contents("g_secd", "comp", wrds_id="your_wrds_id")</code> if you don’t have this set.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>For example, analogues of <code>funda_mod</code> as described in <a href="https://iangow.github.io/far_book/fin-state.html">Chapter 6</a> of <span class="citation" data-cites="gow2024empirical">Gow and Ding (<a href="#ref-gow2024empirical" role="doc-biblioref">2024</a>)</span>.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Whether queries can use such shortcuts obviously depends on the specifics of the available indexes (in this case, there is no index to use for <code>curcdd</code>), but also on whether the backend system will use them for the query.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>Note that <code>system_time()</code> comes from the <code>farr</code> package.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>Note that the PostgreSQL server, like SAS, also has one or more indexes, which occupy an additional 15.75 GB.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>A recent update to <code>db2pq</code> means that the “last updated” string comes from the comments appended to the PostgreSQL table.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>